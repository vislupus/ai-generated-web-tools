<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N5 Kanji Drill (103 Kanji)</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; }
        header { background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        h1 { color: #667eea; font-size: 2.2em; margin-bottom: 5px; }
        .subtitle { color: #666; font-size: 1em; margin-bottom: 20px; }
        .nav-buttons { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; }
        .nav-btn { background: #e0e5ec; color: #667eea; border: 2px solid #667eea; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-size: 1em; font-weight: bold; transition: all 0.3s; }
        .nav-btn:hover, .nav-btn.active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; transform: translateY(-2px); }
        section { background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); display: none; }
        section.active { display: block; }
        h2 { color: #667eea; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 3px solid #667eea; }
        .search-box { margin-bottom: 20px; }
        .search-box input { width: 100%; padding: 15px 20px; font-size: 1.1em; border: 2px solid #ddd; border-radius: 30px; outline: none; }
        .search-box input:focus { border-color: #667eea; }
        .draw-section { background: #f8f9fa; border-radius: 15px; padding: 20px; margin-bottom: 25px; }
        .draw-section h3 { color: #667eea; margin-bottom: 15px; font-size: 1.1em; text-align: center; }
        .canvas-container { display: flex; gap: 20px; align-items: flex-start; justify-content: center; flex-wrap: wrap; }
        .draw-canvas { border: 3px solid #667eea; border-radius: 10px; background: white; cursor: crosshair; touch-action: none; }
        .draw-controls { display: flex; flex-direction: column; gap: 10px; }
        .draw-btn { padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 1em; font-weight: bold; transition: all 0.3s; }
        .draw-btn.clear { background: #dc3545; color: white; }
        .draw-btn.undo { background: #ffc107; color: #333; }
        .draw-btn:hover { transform: scale(1.05); }
        .recognition-result { margin-top: 15px; padding: 15px; background: white; border-radius: 10px; min-height: 70px; text-align: center; }
        .candidates { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
        .candidate { font-size: 2.2em; padding: 10px 18px; background: #f0f3ff; border: 2px solid #667eea; border-radius: 10px; cursor: pointer; transition: all 0.3s; font-family: "Hiragino Kaku Gothic Pro", "MS Gothic", sans-serif; }
        .candidate:hover { background: #667eea; color: white; transform: scale(1.1); }
        .recognition-status { color: #999; font-size: 0.95em; }
        .kanji-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .kanji-card { background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%); border-radius: 12px; padding: 20px; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; }
        .kanji-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.15); }
        .kanji-card.hidden { display: none; }
        .kanji-char { font-size: 3.5em; text-align: center; color: #333; margin-bottom: 10px; font-family: "Hiragino Kaku Gothic Pro", "MS Gothic", sans-serif; }
        .kanji-meaning { text-align: center; font-size: 1.2em; color: #e91e63; font-weight: bold; margin-bottom: 15px; }
        .kanji-readings { background: white; border-radius: 8px; padding: 10px; margin-bottom: 10px; }
        .reading-label { font-weight: bold; font-size: 0.9em; }
        .reading-label.onyomi { color: #ff9800; }
        .reading-label.kunyomi { color: #2196f3; }
        .example-word { background: #667eea; color: white; border-radius: 8px; padding: 10px; font-size: 0.95em; }
        .example-word strong { display: block; font-size: 1.2em; margin-bottom: 5px; }
        .no-results { text-align: center; padding: 40px; color: #666; font-size: 1.2em; }
        .quiz-options { background: #f8f9fa; border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .quiz-options h3 { color: #667eea; margin-bottom: 15px; font-size: 1.1em; }
        .option-group { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px; align-items: center; }
        .option-group label { font-weight: bold; margin-right: 10px; color: #555; }
        .filter-btn { padding: 8px 16px; border: 2px solid #667eea; background: white; color: #667eea; border-radius: 20px; cursor: pointer; font-size: 0.9em; transition: all 0.3s; }
        .filter-btn:hover, .filter-btn.active { background: #667eea; color: white; }
        .filter-btn.meaning-type { border-color: #e91e63; color: #e91e63; }
        .filter-btn.meaning-type:hover, .filter-btn.meaning-type.active { background: #e91e63; color: white; }
        .filter-btn.onyomi-type { border-color: #ff9800; color: #ff9800; }
        .filter-btn.onyomi-type:hover, .filter-btn.onyomi-type.active { background: #ff9800; color: white; }
        .filter-btn.kunyomi-type { border-color: #2196f3; color: #2196f3; }
        .filter-btn.kunyomi-type:hover, .filter-btn.kunyomi-type.active { background: #2196f3; color: white; }
        .start-quiz-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 15px 40px; font-size: 1.1em; border-radius: 25px; cursor: pointer; font-weight: bold; }
        .quiz-header { background: #f8f9fa; padding: 15px 20px; border-radius: 10px; margin-bottom: 20px; }
        .quiz-progress { font-weight: bold; color: #667eea; font-size: 1.1em; }
        .quiz-question { background: #fff; border: 2px solid #e0e0e0; border-radius: 12px; padding: 25px; margin-bottom: 20px; }
        .question-number { display: inline-block; background: #667eea; color: white; padding: 5px 15px; border-radius: 20px; font-weight: bold; margin-bottom: 15px; }
        .question-text { font-size: 1.3em; margin-bottom: 20px; color: #333; }
        .kanji-display { font-size: 1.8em; font-weight: bold; display: inline-block; padding: 5px 15px; border-radius: 8px; font-family: "Hiragino Kaku Gothic Pro", "MS Gothic", sans-serif; }
        .kanji-display.meaning-q { background: #fce4ec; color: #e91e63; }
        .kanji-display.onyomi-q { background: #fff3e0; color: #ff9800; }
        .kanji-display.kunyomi-q { background: #e3f2fd; color: #2196f3; }
        .options { display: flex; flex-direction: column; gap: 12px; }
        .option { display: flex; align-items: center; padding: 15px 20px; background: #fafafa; border: 2px solid #e0e0e0; border-radius: 10px; cursor: pointer; transition: all 0.2s; }
        .option:hover { border-color: #667eea; background: #f0f3ff; }
        .option input { display: none; }
        .option-number { width: 35px; height: 35px; background: #667eea; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; }
        .option.selected { border-color: #667eea; background: #e8edff; }
        .option.selected .option-number { background: #764ba2; }
        .option label { cursor: pointer; flex: 1; font-size: 1.15em; }
        /* CORRECT = YELLOW, WRONG = RED */
        .option.correct { background: #fff3cd !important; border-color: #ffc107 !important; border-width: 3px; }
        .option.correct .option-number { background: #ffc107 !important; color: #333 !important; }
        .option.correct-selected { background: #d4edda !important; border-color: #28a745 !important; border-width: 3px; }
        .option.correct-selected .option-number { background: #28a745 !important; color: white !important; }
        .option.incorrect { background: #f8d7da !important; border-color: #dc3545 !important; border-width: 3px; }
        .option.incorrect .option-number { background: #dc3545 !important; color: white !important; }
        .quiz-actions { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 30px; }
        .action-btn { padding: 15px 35px; font-size: 1.1em; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s; border: none; }
        .action-btn.check { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; }
        .action-btn.retry { background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); color: #333; }
        .action-btn.new-quiz { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .action-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        /* RESULTS - VERY IMPORTANT */
        #result { text-align: center; font-size: 1.5em; padding: 30px; border-radius: 15px; margin-top: 25px; font-weight: bold; }
        #result.good { background: #d4edda; color: #155724; border: 4px solid #28a745; }
        #result.medium { background: #fff3cd; color: #856404; border: 4px solid #ffc107; }
        #result.poor { background: #f8d7da; color: #721c24; border: 4px solid #dc3545; }
        .handwriting-mode { text-align: center; padding: 20px; }
        .hw-question { font-size: 1.5em; margin-bottom: 20px; }
        .hw-hint { font-size: 1.1em; color: #666; margin-bottom: 20px; }
        .hw-result { margin-top: 20px; padding: 20px; border-radius: 12px; font-size: 1.3em; }
        .hw-result.correct { background: #d4edda; color: #155724; }
        .hw-result.incorrect { background: #f8d7da; color: #721c24; }
        .hw-progress { margin-bottom: 20px; font-size: 1.1em; color: #667eea; font-weight: bold; }
        .hw-controls { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 20px; }
        /* MODAL */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center; }
        .modal.show { display: flex; }
        .modal-content { background: white; border-radius: 20px; padding: 30px; max-width: 550px; width: 90%; max-height: 90vh; overflow-y: auto; position: relative; }
        .modal-close { position: absolute; top: 15px; right: 20px; font-size: 2em; cursor: pointer; color: #999; }
        .modal-close:hover { color: #333; }
        .modal-kanji { font-size: 5em; text-align: center; font-family: "Hiragino Kaku Gothic Pro", "MS Gothic", sans-serif; margin-bottom: 10px; }
        .stroke-order-container { text-align: center; margin: 15px 0; min-height: 220px; background: #f8f9fa; border-radius: 10px; padding: 15px; }
        #strokeOrderDisplay { display: inline-block; }
        #strokeOrderDisplay svg { max-width: 200px; max-height: 200px; }
        .stroke-controls { display: flex; gap: 8px; justify-content: center; margin-top: 15px; flex-wrap: wrap; }
        .stroke-btn { padding: 10px 16px; border: 2px solid #667eea; background: white; color: #667eea; border-radius: 20px; cursor: pointer; transition: all 0.3s; font-size: 0.85em; font-weight: bold; }
        .stroke-btn:hover { background: #667eea; color: white; }
        .stroke-btn.radical-btn { border-color: #e91e63; color: #e91e63; }
        .stroke-btn.radical-btn:hover { background: #e91e63; color: white; }
        .stroke-btn.component-btn { border-color: #4caf50; color: #4caf50; }
        .stroke-btn.component-btn:hover { background: #4caf50; color: white; }
        .stroke-info { margin-top: 15px; padding: 12px; background: #e8f5e9; border-radius: 8px; font-size: 0.95em; text-align: center; }
        .modal-info { background: #f8f9fa; border-radius: 10px; padding: 15px; margin-top: 15px; }
        .modal-info h4 { color: #667eea; margin-bottom: 10px; }
        .modal-info p { margin: 5px 0; }
        @media (max-width: 600px) {
            h1 { font-size: 1.6em; }
            .kanji-char { font-size: 2.5em; }
            .nav-buttons { flex-direction: column; }
            .nav-btn { width: 100%; }
            section { padding: 15px; }
            .draw-canvas { width: 220px !important; height: 220px !important; }
            .modal-kanji { font-size: 4em; }
            .stroke-btn { padding: 8px 12px; font-size: 0.75em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>JLPT N5 Êº¢Â≠ó„Éâ„É™„É´</h1>
            <p class="subtitle">103 Essential Kanji for JLPT N5</p>
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showSection('kanji-list', this)">üìö Êº¢Â≠ó„É™„Çπ„Éà</button>
                <button class="nav-btn" onclick="showSection('quiz-section', this)">üìù „ÇØ„Ç§„Ç∫</button>
                <button class="nav-btn" onclick="showSection('handwriting-section', this)">‚úèÔ∏è ÊâãÊõ∏„ÅçÁ∑¥Áøí</button>
            </div>
        </header>

        <section id="kanji-list" class="active">
            <h2>üìö JLPT N5 Êº¢Â≠ó„É™„Çπ„Éà (103Â≠ó)</h2>
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="üîç Ê§úÁ¥¢: Êº¢Â≠ó„ÄÅÊÑèÂë≥„ÄÅË™≠„ÅøÊñπ..." oninput="filterKanji()">
            </div>
            <div class="draw-section">
                <h3>‚úèÔ∏è Êº¢Â≠ó„ÇíÊõ∏„ÅÑ„Å¶Ê§úÁ¥¢ (Google Handwriting)</h3>
                <div class="canvas-container">
                    <canvas id="searchCanvas" class="draw-canvas" width="280" height="280"></canvas>
                    <div class="draw-controls">
                        <button class="draw-btn undo" onclick="undoStroke('search')">‚Ü© Êàª„Åô</button>
                        <button class="draw-btn clear" onclick="clearCanvas('search')">‚úï Ê∂àÂéª</button>
                    </div>
                </div>
                <div class="recognition-result">
                    <div class="candidates" id="searchCandidates">
                        <span class="recognition-status">Êº¢Â≠ó„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ...</span>
                    </div>
                </div>
            </div>
            <div class="kanji-grid" id="kanjiGrid"></div>
            <div class="no-results" id="noResults" style="display: none;">Ê§úÁ¥¢ÁµêÊûú„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>
        </section>

        <section id="quiz-section">
            <h2>üìù JLPT N5 Êº¢Â≠ó„ÇØ„Ç§„Ç∫</h2>
            <div class="quiz-options" id="quizOptions">
                <h3>„ÇØ„Ç§„Ç∫Ë®≠ÂÆö</h3>
                <div class="option-group">
                    <label>ÂïèÈ°å„Çø„Ç§„Éó:</label>
                    <button class="filter-btn meaning-type" onclick="setQuizType('meaning', this)">ÊÑèÂë≥„ÅÆ„Åø</button>
                    <button class="filter-btn onyomi-type" onclick="setQuizType('onyomi', this)">Èü≥Ë™≠„Åø„ÅÆ„Åø</button>
                    <button class="filter-btn kunyomi-type" onclick="setQuizType('kunyomi', this)">Ë®ìË™≠„Åø„ÅÆ„Åø</button>
                    <button class="filter-btn active" onclick="setQuizType('mixed', this)">Ê∑∑Âêà</button>
                </div>
                <div class="option-group">
                    <label>ÂïèÈ°åÊï∞:</label>
                    <button class="filter-btn" onclick="setQuizCount(10, this)">10Âïè</button>
                    <button class="filter-btn" onclick="setQuizCount(20, this)">20Âïè</button>
                    <button class="filter-btn active" onclick="setQuizCount(50, this)">50Âïè</button>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="start-quiz-btn" onclick="startQuiz()">„ÇØ„Ç§„Ç∫„ÇíÂßã„ÇÅ„Çã</button>
                </div>
            </div>
            <div id="quizContainer" style="display: none;">
                <div class="quiz-header">
                    <span class="quiz-progress" id="quizProgress">ÂïèÈ°åÊï∞: 0Âïè</span>
                </div>
                <div id="quizQuestions"></div>
                <div class="quiz-actions">
                    <button class="action-btn check" id="checkBtn" onclick="checkAnswers()">Êé°ÁÇπ„Åô„Çã</button>
                    <button class="action-btn retry" id="retryBtn" style="display:none;" onclick="retryWrong()">ÈñìÈÅï„ÅÑ„ÇíÂæ©Áøí</button>
                    <button class="action-btn new-quiz" onclick="showQuizOptions()">Êñ∞„Åó„ÅÑ„ÇØ„Ç§„Ç∫</button>
                </div>
                <div id="result" style="display:none;"></div>
            </div>
        </section>

        <section id="handwriting-section">
            <h2>‚úèÔ∏è ÊâãÊõ∏„ÅçÁ∑¥Áøí„É¢„Éº„Éâ</h2>
            <div class="quiz-options" id="hwOptions">
                <h3>Á∑¥ÁøíË®≠ÂÆö</h3>
                <div class="option-group">
                    <label>ÂïèÈ°å„Çø„Ç§„Éó:</label>
                    <button class="filter-btn meaning-type" onclick="setHWType('meaning', this)">ÊÑèÂë≥‚ÜíÊº¢Â≠ó</button>
                    <button class="filter-btn onyomi-type" onclick="setHWType('onyomi', this)">Èü≥Ë™≠„Åø‚ÜíÊº¢Â≠ó</button>
                    <button class="filter-btn kunyomi-type" onclick="setHWType('kunyomi', this)">Ë®ìË™≠„Åø‚ÜíÊº¢Â≠ó</button>
                    <button class="filter-btn active" onclick="setHWType('mixed', this)">Ê∑∑Âêà</button>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="start-quiz-btn" onclick="startHandwritingQuiz()">Á∑¥Áøí„ÇíÂßã„ÇÅ„Çã</button>
                </div>
            </div>
            <div id="hwQuizContainer" style="display: none;">
                <div class="handwriting-mode">
                    <div class="hw-progress" id="hwProgress">Ê≠£Ëß£: 0 / ÂõûÁ≠î: 0</div>
                    <div class="hw-question" id="hwQuestion"></div>
                    <div class="hw-hint" id="hwHint"></div>
                    <div style="margin: 20px 0;">
                        <canvas id="hwCanvas" class="draw-canvas" width="280" height="280"></canvas>
                    </div>
                    <div class="hw-controls">
                        <button class="draw-btn undo" onclick="undoStroke('hw')">‚Ü© Êàª„Åô</button>
                        <button class="draw-btn clear" onclick="clearCanvas('hw')">‚úï Ê∂àÂéª</button>
                        <button class="action-btn check" onclick="checkHandwriting()">Á¢∫Ë™ç„Åô„Çã</button>
                    </div>
                    <div class="recognition-result">
                        <div class="candidates" id="hwCandidates">
                            <span class="recognition-status">Êº¢Â≠ó„ÇíÊõ∏„ÅÑ„Å¶„ÄåÁ¢∫Ë™ç„Åô„Çã„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ</span>
                        </div>
                    </div>
                    <div id="hwResult" style="display: none;"></div>
                    <div class="hw-controls" id="hwNextControls" style="display: none;">
                        <button class="action-btn new-quiz" onclick="nextHandwritingQuestion()">Ê¨°„ÅÆÂïèÈ°å</button>
                        <button class="action-btn retry" style="display: inline-block;" onclick="showHWOptions()">Á∑¥ÁøíÁµÇ‰∫Ü</button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Stroke Order Modal -->
    <div class="modal" id="strokeModal" onclick="if(event.target===this)closeModal()">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <div class="modal-kanji" id="modalKanji"></div>
            <div class="stroke-order-container">
                <div id="strokeOrderDisplay"></div>
            </div>
            <div class="stroke-controls">
                <button class="stroke-btn" onclick="animateStrokes()">‚ñ∂ „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥</button>
                <button class="stroke-btn" onclick="resetStrokes()">‚Ü∫ „É™„Çª„ÉÉ„Éà</button>
                <button class="stroke-btn radical-btn" onclick="showRadicals()">üî¥ ÈÉ®È¶ñ„ÇíË°®Á§∫</button>
                <button class="stroke-btn component-btn" onclick="showComponents()">üü¢ ÈÉ®ÂìÅ„ÇíË°®Á§∫</button>
            </div>
            <div class="stroke-info" id="strokeInfo" style="display:none;"></div>
            <div class="modal-info" id="modalInfo">
                <h4>Êº¢Â≠óÊÉÖÂ†±</h4>
                <p id="modalMeaning"></p>
                <p id="modalOnyomi"></p>
                <p id="modalKunyomi"></p>
                <p id="modalExample"></p>
                <p id="modalStrokes"></p>
            </div>
        </div>
    </div>

    <script>
        // ==================== KANJI DATA ====================
        const kanjiData = [
            { kanji: "‰∏Ä", meaning: "one", onyomi: "„ÅÑ„Å°", kunyomi: "„Å≤„Å®(„Å§)", example: "‰∏Ä‰∫∫", exReading: "„Å≤„Å®„Çä", exMeaning: "one person", strokes: 1, radical: "‰∏Ä (one)" },
            { kanji: "‰∫å", meaning: "two", onyomi: "„Å´", kunyomi: "„Åµ„Åü(„Å§)", example: "‰∫å‰∫∫", exReading: "„Åµ„Åü„Çä", exMeaning: "two people", strokes: 2, radical: "‰∫å (two)" },
            { kanji: "‰∏â", meaning: "three", onyomi: "„Åï„Çì", kunyomi: "„Åø(„Å§)", example: "‰∏âÊó•", exReading: "„Åø„Å£„Åã", exMeaning: "3rd day", strokes: 3, radical: "‰∏Ä (one)" },
            { kanji: "Âõõ", meaning: "four", onyomi: "„Åó", kunyomi: "„Çà(„Å§)", example: "ÂõõÊúà", exReading: "„Åó„Åå„Å§", exMeaning: "April", strokes: 5, radical: "Âõó (enclosure)" },
            { kanji: "‰∫î", meaning: "five", onyomi: "„Åî", kunyomi: "„ÅÑ„Å§(„Å§)", example: "‰∫îÊó•", exReading: "„ÅÑ„Å§„Åã", exMeaning: "5th day", strokes: 4, radical: "‰∫å (two)" },
            { kanji: "ÂÖ≠", meaning: "six", onyomi: "„Çç„Åè", kunyomi: "„ÇÄ(„Å§)", example: "ÂÖ≠Êúà", exReading: "„Çç„Åè„Åå„Å§", exMeaning: "June", strokes: 4, radical: "ÂÖ´ (eight)" },
            { kanji: "‰∏É", meaning: "seven", onyomi: "„Åó„Å°", kunyomi: "„Å™„Å™(„Å§)", example: "‰∏ÉÊó•", exReading: "„Å™„ÅÆ„Åã", exMeaning: "7th day", strokes: 2, radical: "‰∏Ä (one)" },
            { kanji: "ÂÖ´", meaning: "eight", onyomi: "„ÅØ„Å°", kunyomi: "„ÇÑ(„Å§)", example: "ÂÖ´Êó•", exReading: "„Çà„ÅÜ„Åã", exMeaning: "8th day", strokes: 2, radical: "ÂÖ´ (eight)" },
            { kanji: "‰πù", meaning: "nine", onyomi: "„Åç„ÇÖ„ÅÜ", kunyomi: "„Åì„Åì„ÅÆ(„Å§)", example: "‰πùÊúà", exReading: "„Åè„Åå„Å§", exMeaning: "September", strokes: 2, radical: "‰πô (second)" },
            { kanji: "ÂçÅ", meaning: "ten", onyomi: "„Åò„ÇÖ„ÅÜ", kunyomi: "„Å®„Åä", example: "ÂçÅÊó•", exReading: "„Å®„Åä„Åã", exMeaning: "10th day", strokes: 2, radical: "ÂçÅ (ten)" },
            { kanji: "Áôæ", meaning: "hundred", onyomi: "„Å≤„ÇÉ„Åè", kunyomi: "„ÇÇ„ÇÇ", example: "ÁôæÂÜÜ", exReading: "„Å≤„ÇÉ„Åè„Åà„Çì", exMeaning: "100 yen", strokes: 6, radical: "ÁôΩ (white)" },
            { kanji: "ÂçÉ", meaning: "thousand", onyomi: "„Åõ„Çì", kunyomi: "„Å°", example: "ÂçÉÂÜÜ", exReading: "„Åõ„Çì„Åà„Çì", exMeaning: "1000 yen", strokes: 3, radical: "ÂçÅ (ten)" },
            { kanji: "‰∏á", meaning: "ten thousand", onyomi: "„Åæ„Çì", kunyomi: "„Çà„Çç„Åö", example: "‰∏Ä‰∏á", exReading: "„ÅÑ„Å°„Åæ„Çì", exMeaning: "10,000", strokes: 3, radical: "‰∏Ä (one)" },
            { kanji: "ÂÜÜ", meaning: "yen, circle", onyomi: "„Åà„Çì", kunyomi: "„Åæ„Çã(„ÅÑ)", example: "‰∫îÁôæÂÜÜ", exReading: "„Åî„Å≤„ÇÉ„Åè„Åà„Çì", exMeaning: "500 yen", strokes: 4, radical: "ÂÜÇ (down box)" },
            { kanji: "Êó•", meaning: "day, sun", onyomi: "„Å´„Å°", kunyomi: "„Å≤", example: "Êó•ÊõúÊó•", exReading: "„Å´„Å°„Çà„ÅÜ„Å≥", exMeaning: "Sunday", strokes: 4, radical: "Êó• (sun)" },
            { kanji: "Êúà", meaning: "month, moon", onyomi: "„Åí„Å§", kunyomi: "„Å§„Åç", example: "ÊúàÊõúÊó•", exReading: "„Åí„Å§„Çà„ÅÜ„Å≥", exMeaning: "Monday", strokes: 4, radical: "Êúà (moon)" },
            { kanji: "ÁÅ´", meaning: "fire", onyomi: "„Åã", kunyomi: "„Å≤", example: "ÁÅ´ÊõúÊó•", exReading: "„Åã„Çà„ÅÜ„Å≥", exMeaning: "Tuesday", strokes: 4, radical: "ÁÅ´ (fire)" },
            { kanji: "Ê∞¥", meaning: "water", onyomi: "„Åô„ÅÑ", kunyomi: "„Åø„Åö", example: "Ê∞¥ÊõúÊó•", exReading: "„Åô„ÅÑ„Çà„ÅÜ„Å≥", exMeaning: "Wednesday", strokes: 4, radical: "Ê∞¥ (water)" },
            { kanji: "Êú®", meaning: "tree, wood", onyomi: "„ÇÇ„Åè", kunyomi: "„Åç", example: "Êú®ÊõúÊó•", exReading: "„ÇÇ„Åè„Çà„ÅÜ„Å≥", exMeaning: "Thursday", strokes: 4, radical: "Êú® (tree)" },
            { kanji: "Èáë", meaning: "gold, money", onyomi: "„Åç„Çì", kunyomi: "„Åã„Å≠", example: "ÈáëÊõúÊó•", exReading: "„Åç„Çì„Çà„ÅÜ„Å≥", exMeaning: "Friday", strokes: 8, radical: "Èáë (metal)" },
            { kanji: "Âúü", meaning: "earth, soil", onyomi: "„Å©", kunyomi: "„Å§„Å°", example: "ÂúüÊõúÊó•", exReading: "„Å©„Çà„ÅÜ„Å≥", exMeaning: "Saturday", strokes: 3, radical: "Âúü (earth)" },
            { kanji: "Âπ¥", meaning: "year", onyomi: "„Å≠„Çì", kunyomi: "„Å®„Åó", example: "‰ªäÂπ¥", exReading: "„Åì„Å®„Åó", exMeaning: "this year", strokes: 6, radical: "Âπ≤ (dry)" },
            { kanji: "ÊôÇ", meaning: "time, hour", onyomi: "„Åò", kunyomi: "„Å®„Åç", example: "ÊôÇÈñì", exReading: "„Åò„Åã„Çì", exMeaning: "time", strokes: 10, radical: "Êó• (sun)" },
            { kanji: "ÂàÜ", meaning: "minute, part", onyomi: "„Åµ„Çì", kunyomi: "„Çè(„Åë„Çã)", example: "ÂçÅÂàÜ", exReading: "„Åò„ÇÖ„Å£„Å∑„Çì", exMeaning: "10 minutes", strokes: 4, radical: "ÂàÄ (knife)" },
            { kanji: "Âçä", meaning: "half", onyomi: "„ÅØ„Çì", kunyomi: "„Å™„Åã(„Å∞)", example: "ÂçäÂàÜ", exReading: "„ÅØ„Çì„Å∂„Çì", exMeaning: "half", strokes: 5, radical: "ÂçÅ (ten)" },
            { kanji: "ÈÄ±", meaning: "week", onyomi: "„Åó„ÇÖ„ÅÜ", kunyomi: "„Åæ„Çè„Çä", example: "‰ªäÈÄ±", exReading: "„Åì„Çì„Åó„ÇÖ„ÅÜ", exMeaning: "this week", strokes: 11, radical: "Ëæ∂ (walk)" },
            { kanji: "Âçà", meaning: "noon", onyomi: "„Åî", kunyomi: "„ÅÜ„Åæ", example: "ÂçàÂâç", exReading: "„Åî„Åú„Çì", exMeaning: "AM", strokes: 4, radical: "ÂçÅ (ten)" },
            { kanji: "Ââç", meaning: "before, front", onyomi: "„Åú„Çì", kunyomi: "„Åæ„Åà", example: "ÂêçÂâç", exReading: "„Å™„Åæ„Åà", exMeaning: "name", strokes: 9, radical: "ÂàÄ (knife)" },
            { kanji: "Âæå", meaning: "after, behind", onyomi: "„Åî", kunyomi: "„ÅÜ„Åó(„Çç)", example: "ÂçàÂæå", exReading: "„Åî„Åî", exMeaning: "PM", strokes: 9, radical: "ÂΩ≥ (step)" },
            { kanji: "‰ªä", meaning: "now", onyomi: "„Åì„Çì", kunyomi: "„ÅÑ„Åæ", example: "‰ªäÊó•", exReading: "„Åç„Çá„ÅÜ", exMeaning: "today", strokes: 4, radical: "‰∫∫ (person)" },
            { kanji: "ÂÖà", meaning: "previous", onyomi: "„Åõ„Çì", kunyomi: "„Åï„Åç", example: "ÂÖàÁîü", exReading: "„Åõ„Çì„Åõ„ÅÑ", exMeaning: "teacher", strokes: 6, radical: "ÂÑø (legs)" },
            { kanji: "Êù•", meaning: "come, next", onyomi: "„Çâ„ÅÑ", kunyomi: "„Åè(„Çã)", example: "Êù•ÈÄ±", exReading: "„Çâ„ÅÑ„Åó„ÇÖ„ÅÜ", exMeaning: "next week", strokes: 7, radical: "Êú® (tree)" },
            { kanji: "ÊØé", meaning: "every", onyomi: "„Åæ„ÅÑ", kunyomi: "„Åî„Å®", example: "ÊØéÊó•", exReading: "„Åæ„ÅÑ„Å´„Å°", exMeaning: "every day", strokes: 6, radical: "ÊØç (mother)" },
            { kanji: "Èñì", meaning: "between", onyomi: "„Åã„Çì", kunyomi: "„ÅÇ„ÅÑ„Å†", example: "ÊôÇÈñì", exReading: "„Åò„Åã„Çì", exMeaning: "time", strokes: 12, radical: "ÈñÄ (gate)" },
            { kanji: "‰∫∫", meaning: "person", onyomi: "„Åò„Çì", kunyomi: "„Å≤„Å®", example: "Êó•Êú¨‰∫∫", exReading: "„Å´„Åª„Çì„Åò„Çì", exMeaning: "Japanese", strokes: 2, radical: "‰∫∫ (person)" },
            { kanji: "Áî∑", meaning: "man", onyomi: "„Å†„Çì", kunyomi: "„Åä„Å®„Åì", example: "Áî∑„ÅÆÂ≠ê", exReading: "„Åä„Å®„Åì„ÅÆ„Åì", exMeaning: "boy", strokes: 7, radical: "Áî∞ (field)" },
            { kanji: "Â•≥", meaning: "woman", onyomi: "„Åò„Çá", kunyomi: "„Åä„Çì„Å™", example: "Â•≥„ÅÆÂ≠ê", exReading: "„Åä„Çì„Å™„ÅÆ„Åì", exMeaning: "girl", strokes: 3, radical: "Â•≥ (woman)" },
            { kanji: "Â≠ê", meaning: "child", onyomi: "„Åó", kunyomi: "„Åì", example: "Â≠ê‰æõ", exReading: "„Åì„Å©„ÇÇ", exMeaning: "child", strokes: 3, radical: "Â≠ê (child)" },
            { kanji: "ÊØç", meaning: "mother", onyomi: "„Åº", kunyomi: "„ÅØ„ÅØ", example: "„ÅäÊØç„Åï„Çì", exReading: "„Åä„Åã„ÅÇ„Åï„Çì", exMeaning: "mother", strokes: 5, radical: "ÊØç (mother)" },
            { kanji: "Áà∂", meaning: "father", onyomi: "„Åµ", kunyomi: "„Å°„Å°", example: "„ÅäÁà∂„Åï„Çì", exReading: "„Åä„Å®„ÅÜ„Åï„Çì", exMeaning: "father", strokes: 4, radical: "Áà∂ (father)" },
            { kanji: "Âèã", meaning: "friend", onyomi: "„ÇÜ„ÅÜ", kunyomi: "„Å®„ÇÇ", example: "ÂèãÈÅî", exReading: "„Å®„ÇÇ„Å†„Å°", exMeaning: "friend", strokes: 4, radical: "Âèà (again)" },
            { kanji: "Âêç", meaning: "name", onyomi: "„ÇÅ„ÅÑ", kunyomi: "„Å™", example: "ÂêçÂâç", exReading: "„Å™„Åæ„Åà", exMeaning: "name", strokes: 6, radical: "Âè£ (mouth)" },
            { kanji: "ÂõΩ", meaning: "country", onyomi: "„Åì„Åè", kunyomi: "„Åè„Å´", example: "Â§ñÂõΩ", exReading: "„Åå„ÅÑ„Åì„Åè", exMeaning: "foreign country", strokes: 8, radical: "Âõó (enclosure)" },
            { kanji: "Êú¨", meaning: "book", onyomi: "„Åª„Çì", kunyomi: "„ÇÇ„Å®", example: "Êó•Êú¨", exReading: "„Å´„Åª„Çì", exMeaning: "Japan", strokes: 5, radical: "Êú® (tree)" },
            { kanji: "Â≠¶", meaning: "study", onyomi: "„Åå„Åè", kunyomi: "„Åæ„Å™(„Å∂)", example: "Â≠¶Áîü", exReading: "„Åå„Åè„Åõ„ÅÑ", exMeaning: "student", strokes: 8, radical: "Â≠ê (child)" },
            { kanji: "Ê†°", meaning: "school", onyomi: "„Åì„ÅÜ", kunyomi: "-", example: "Â≠¶Ê†°", exReading: "„Åå„Å£„Åì„ÅÜ", exMeaning: "school", strokes: 10, radical: "Êú® (tree)" },
            { kanji: "Áîü", meaning: "life", onyomi: "„Åõ„ÅÑ", kunyomi: "„ÅÑ(„Åç„Çã)", example: "ÂÖàÁîü", exReading: "„Åõ„Çì„Åõ„ÅÑ", exMeaning: "teacher", strokes: 5, radical: "Áîü (life)" },
            { kanji: "Â§ß", meaning: "big", onyomi: "„Å†„ÅÑ", kunyomi: "„Åä„Åä(„Åç„ÅÑ)", example: "Â§ßÂ≠¶", exReading: "„Å†„ÅÑ„Åå„Åè", exMeaning: "university", strokes: 3, radical: "Â§ß (big)" },
            { kanji: "Â∞è", meaning: "small", onyomi: "„Åó„Çá„ÅÜ", kunyomi: "„Å°„ÅÑ(„Åï„ÅÑ)", example: "Â∞èÂ≠¶Ê†°", exReading: "„Åó„Çá„ÅÜ„Åå„Å£„Åì„ÅÜ", exMeaning: "elementary", strokes: 3, radical: "Â∞è (small)" },
            { kanji: "‰∏≠", meaning: "middle", onyomi: "„Å°„ÇÖ„ÅÜ", kunyomi: "„Å™„Åã", example: "‰∏≠Â≠¶Ê†°", exReading: "„Å°„ÇÖ„ÅÜ„Åå„Å£„Åì„ÅÜ", exMeaning: "middle school", strokes: 4, radical: "‰∏® (line)" },
            { kanji: "È´ò", meaning: "tall, expensive", onyomi: "„Åì„ÅÜ", kunyomi: "„Åü„Åã(„ÅÑ)", example: "È´òÊ†°", exReading: "„Åì„ÅÜ„Åì„ÅÜ", exMeaning: "high school", strokes: 10, radical: "È´ò (tall)" },
            { kanji: "Èï∑", meaning: "long", onyomi: "„Å°„Çá„ÅÜ", kunyomi: "„Å™„Åå(„ÅÑ)", example: "Èï∑„ÅÑ", exReading: "„Å™„Åå„ÅÑ", exMeaning: "long", strokes: 8, radical: "Èï∑ (long)" },
            { kanji: "Êñ∞", meaning: "new", onyomi: "„Åó„Çì", kunyomi: "„ÅÇ„Åü„Çâ(„Åó„ÅÑ)", example: "Êñ∞ËÅû", exReading: "„Åó„Çì„Å∂„Çì", exMeaning: "newspaper", strokes: 13, radical: "Êñ§ (axe)" },
            { kanji: "Âè§", meaning: "old", onyomi: "„Åì", kunyomi: "„Åµ„Çã(„ÅÑ)", example: "Âè§„ÅÑ", exReading: "„Åµ„Çã„ÅÑ", exMeaning: "old", strokes: 5, radical: "Âè£ (mouth)" },
            { kanji: "Â§ö", meaning: "many", onyomi: "„Åü", kunyomi: "„Åä„Åä(„ÅÑ)", example: "Â§ö„ÅÑ", exReading: "„Åä„Åä„ÅÑ", exMeaning: "many", strokes: 6, radical: "Â§ï (evening)" },
            { kanji: "Â∞ë", meaning: "few", onyomi: "„Åó„Çá„ÅÜ", kunyomi: "„Åô„Åè(„Å™„ÅÑ)", example: "Â∞ë„Åó", exReading: "„Åô„Åì„Åó", exMeaning: "a little", strokes: 4, radical: "Â∞è (small)" },
            { kanji: "ÂÆâ", meaning: "cheap", onyomi: "„ÅÇ„Çì", kunyomi: "„ÇÑ„Åô(„ÅÑ)", example: "ÂÆâ„ÅÑ", exReading: "„ÇÑ„Åô„ÅÑ", exMeaning: "cheap", strokes: 6, radical: "ÂÆÄ (roof)" },
            { kanji: "ÁôΩ", meaning: "white", onyomi: "„ÅØ„Åè", kunyomi: "„Åó„Çç(„ÅÑ)", example: "ÁôΩ„ÅÑ", exReading: "„Åó„Çç„ÅÑ", exMeaning: "white", strokes: 5, radical: "ÁôΩ (white)" },
            { kanji: "‰∏ä", meaning: "up", onyomi: "„Åò„Çá„ÅÜ", kunyomi: "„ÅÜ„Åà", example: "‰∏äÊâã", exReading: "„Åò„Çá„ÅÜ„Åö", exMeaning: "skillful", strokes: 3, radical: "‰∏Ä (one)" },
            { kanji: "‰∏ã", meaning: "down", onyomi: "„Åã", kunyomi: "„Åó„Åü", example: "‰∏ãÊâã", exReading: "„Å∏„Åü", exMeaning: "unskillful", strokes: 3, radical: "‰∏Ä (one)" },
            { kanji: "Âè≥", meaning: "right", onyomi: "„ÅÜ", kunyomi: "„Åø„Åé", example: "Âè≥", exReading: "„Åø„Åé", exMeaning: "right", strokes: 5, radical: "Âè£ (mouth)" },
            { kanji: "Â∑¶", meaning: "left", onyomi: "„Åï", kunyomi: "„Å≤„Å†„Çä", example: "Â∑¶", exReading: "„Å≤„Å†„Çä", exMeaning: "left", strokes: 5, radical: "Â∑• (work)" },
            { kanji: "Âåó", meaning: "north", onyomi: "„Åª„Åè", kunyomi: "„Åç„Åü", example: "Âåó", exReading: "„Åç„Åü", exMeaning: "north", strokes: 5, radical: "Âåï (spoon)" },
            { kanji: "Âçó", meaning: "south", onyomi: "„Å™„Çì", kunyomi: "„Åø„Å™„Åø", example: "Âçó", exReading: "„Åø„Å™„Åø", exMeaning: "south", strokes: 9, radical: "ÂçÅ (ten)" },
            { kanji: "Êù±", meaning: "east", onyomi: "„Å®„ÅÜ", kunyomi: "„Å≤„Åå„Åó", example: "Êù±‰∫¨", exReading: "„Å®„ÅÜ„Åç„Çá„ÅÜ", exMeaning: "Tokyo", strokes: 8, radical: "Êú® (tree)" },
            { kanji: "Ë•ø", meaning: "west", onyomi: "„Åõ„ÅÑ", kunyomi: "„Å´„Åó", example: "Ë•ø", exReading: "„Å´„Åó", exMeaning: "west", strokes: 6, radical: "Ë¶Ä (west)" },
            { kanji: "Â§ñ", meaning: "outside", onyomi: "„Åå„ÅÑ", kunyomi: "„Åù„Å®", example: "Â§ñÂõΩ", exReading: "„Åå„ÅÑ„Åì„Åè", exMeaning: "abroad", strokes: 5, radical: "Â§ï (evening)" },
            { kanji: "Â±±", meaning: "mountain", onyomi: "„Åï„Çì", kunyomi: "„ÇÑ„Åæ", example: "ÂØåÂ£´Â±±", exReading: "„Åµ„Åò„Åï„Çì", exMeaning: "Mt. Fuji", strokes: 3, radical: "Â±± (mountain)" },
            { kanji: "Â∑ù", meaning: "river", onyomi: "„Åõ„Çì", kunyomi: "„Åã„Çè", example: "Â∑ù", exReading: "„Åã„Çè", exMeaning: "river", strokes: 3, radical: "Â∑ù (river)" },
            { kanji: "Â§©", meaning: "heaven", onyomi: "„Å¶„Çì", kunyomi: "„ÅÇ„ÇÅ", example: "Â§©Ê∞ó", exReading: "„Å¶„Çì„Åç", exMeaning: "weather", strokes: 4, radical: "Â§ß (big)" },
            { kanji: "Ê∞ó", meaning: "spirit", onyomi: "„Åç", kunyomi: "„ÅÑ„Åç", example: "ÂÖÉÊ∞ó", exReading: "„Åí„Çì„Åç", exMeaning: "healthy", strokes: 6, radical: "Ê∞î (steam)" },
            { kanji: "Èõ®", meaning: "rain", onyomi: "„ÅÜ", kunyomi: "„ÅÇ„ÇÅ", example: "Èõ®", exReading: "„ÅÇ„ÇÅ", exMeaning: "rain", strokes: 8, radical: "Èõ® (rain)" },
            { kanji: "Èõª", meaning: "electricity", onyomi: "„Åß„Çì", kunyomi: "-", example: "ÈõªË©±", exReading: "„Åß„Çì„Çè", exMeaning: "telephone", strokes: 13, radical: "Èõ® (rain)" },
            { kanji: "Ëªä", meaning: "car", onyomi: "„Åó„ÇÉ", kunyomi: "„Åè„Çã„Åæ", example: "ÈõªËªä", exReading: "„Åß„Çì„Åó„ÇÉ", exMeaning: "train", strokes: 7, radical: "Ëªä (car)" },
            { kanji: "ÈßÖ", meaning: "station", onyomi: "„Åà„Åç", kunyomi: "-", example: "ÈßÖ", exReading: "„Åà„Åç", exMeaning: "station", strokes: 14, radical: "È¶¨ (horse)" },
            { kanji: "ÈÅì", meaning: "road", onyomi: "„Å©„ÅÜ", kunyomi: "„Åø„Å°", example: "ÈÅì", exReading: "„Åø„Å°", exMeaning: "road", strokes: 12, radical: "Ëæ∂ (walk)" },
            { kanji: "Â∫ó", meaning: "shop", onyomi: "„Å¶„Çì", kunyomi: "„Åø„Åõ", example: "Â∫ó", exReading: "„Åø„Åõ", exMeaning: "shop", strokes: 8, radical: "Âπø (cliff)" },
            { kanji: "Á§æ", meaning: "company", onyomi: "„Åó„ÇÉ", kunyomi: "„ÇÑ„Åó„Çç", example: "‰ºöÁ§æ", exReading: "„Åã„ÅÑ„Åó„ÇÉ", exMeaning: "company", strokes: 7, radical: "Á§∫ (altar)" },
            { kanji: "‰ºö", meaning: "meet", onyomi: "„Åã„ÅÑ", kunyomi: "„ÅÇ(„ÅÜ)", example: "‰ºöÁ§æ", exReading: "„Åã„ÅÑ„Åó„ÇÉ", exMeaning: "company", strokes: 6, radical: "‰∫∫ (person)" },
            { kanji: "Ë™û", meaning: "language", onyomi: "„Åî", kunyomi: "„Åã„Åü(„Çã)", example: "Êó•Êú¨Ë™û", exReading: "„Å´„Åª„Çì„Åî", exMeaning: "Japanese", strokes: 14, radical: "Ë®Ä (speech)" },
            { kanji: "Ë©±", meaning: "talk", onyomi: "„Çè", kunyomi: "„ÅØ„Å™(„Åô)", example: "ÈõªË©±", exReading: "„Åß„Çì„Çè", exMeaning: "telephone", strokes: 13, radical: "Ë®Ä (speech)" },
            { kanji: "Ë®Ä", meaning: "say", onyomi: "„Åí„Çì", kunyomi: "„ÅÑ(„ÅÜ)", example: "Ë®Ä„ÅÜ", exReading: "„ÅÑ„ÅÜ", exMeaning: "to say", strokes: 7, radical: "Ë®Ä (speech)" },
            { kanji: "Ë™≠", meaning: "read", onyomi: "„Å©„Åè", kunyomi: "„Çà(„ÇÄ)", example: "Ë™≠„ÇÄ", exReading: "„Çà„ÇÄ", exMeaning: "to read", strokes: 14, radical: "Ë®Ä (speech)" },
            { kanji: "Êõ∏", meaning: "write", onyomi: "„Åó„Çá", kunyomi: "„Åã(„Åè)", example: "Êõ∏„Åè", exReading: "„Åã„Åè", exMeaning: "to write", strokes: 10, radical: "Êõ∞ (say)" },
            { kanji: "ËÅû", meaning: "hear", onyomi: "„Å∂„Çì", kunyomi: "„Åç(„Åè)", example: "ËÅû„Åè", exReading: "„Åç„Åè", exMeaning: "to listen", strokes: 14, radical: "ËÄ≥ (ear)" },
            { kanji: "Ë¶ã", meaning: "see", onyomi: "„Åë„Çì", kunyomi: "„Åø(„Çã)", example: "Ë¶ã„Çã", exReading: "„Åø„Çã", exMeaning: "to see", strokes: 7, radical: "Ë¶ã (see)" },
            { kanji: "Ë°å", meaning: "go", onyomi: "„Åì„ÅÜ", kunyomi: "„ÅÑ(„Åè)", example: "Ë°å„Åè", exReading: "„ÅÑ„Åè", exMeaning: "to go", strokes: 6, radical: "Ë°å (go)" },
            { kanji: "Âá∫", meaning: "exit", onyomi: "„Åó„ÇÖ„Å§", kunyomi: "„Åß(„Çã)", example: "Âá∫Âè£", exReading: "„Åß„Åê„Å°", exMeaning: "exit", strokes: 5, radical: "Âáµ (container)" },
            { kanji: "ÂÖ•", meaning: "enter", onyomi: "„Å´„ÇÖ„ÅÜ", kunyomi: "„ÅØ„ÅÑ(„Çã)", example: "ÂÖ•Âè£", exReading: "„ÅÑ„Çä„Åê„Å°", exMeaning: "entrance", strokes: 2, radical: "ÂÖ• (enter)" },
            { kanji: "‰ºë", meaning: "rest", onyomi: "„Åç„ÇÖ„ÅÜ", kunyomi: "„ÇÑ„Åô(„ÇÄ)", example: "‰ºë„ÇÄ", exReading: "„ÇÑ„Åô„ÇÄ", exMeaning: "to rest", strokes: 6, radical: "‰∫∫ (person)" },
            { kanji: "Ë≤∑", meaning: "buy", onyomi: "„Å∞„ÅÑ", kunyomi: "„Åã(„ÅÜ)", example: "Ë≤∑„ÅÜ", exReading: "„Åã„ÅÜ", exMeaning: "to buy", strokes: 12, radical: "Ë≤ù (shell)" },
            { kanji: "È£ü", meaning: "eat", onyomi: "„Åó„Çá„Åè", kunyomi: "„Åü(„Åπ„Çã)", example: "È£ü„Åπ„Çã", exReading: "„Åü„Åπ„Çã", exMeaning: "to eat", strokes: 9, radical: "È£ü (eat)" },
            { kanji: "È£≤", meaning: "drink", onyomi: "„ÅÑ„Çì", kunyomi: "„ÅÆ(„ÇÄ)", example: "È£≤„ÇÄ", exReading: "„ÅÆ„ÇÄ", exMeaning: "to drink", strokes: 12, radical: "È£ü (eat)" },
            { kanji: "Á´ã", meaning: "stand", onyomi: "„Çä„Å§", kunyomi: "„Åü(„Å§)", example: "Á´ã„Å§", exReading: "„Åü„Å§", exMeaning: "to stand", strokes: 5, radical: "Á´ã (stand)" },
            { kanji: "‰Ωï", meaning: "what", onyomi: "„Åã", kunyomi: "„Å™„Å´", example: "‰Ωï", exReading: "„Å™„Å´", exMeaning: "what", strokes: 7, radical: "‰∫∫ (person)" },
            { kanji: "Êâã", meaning: "hand", onyomi: "„Åó„ÇÖ", kunyomi: "„Å¶", example: "ÊâãÁ¥ô", exReading: "„Å¶„Åå„Åø", exMeaning: "letter", strokes: 4, radical: "Êâã (hand)" },
            { kanji: "Ë∂≥", meaning: "foot", onyomi: "„Åù„Åè", kunyomi: "„ÅÇ„Åó", example: "Ë∂≥", exReading: "„ÅÇ„Åó", exMeaning: "foot", strokes: 7, radical: "Ë∂≥ (foot)" },
            { kanji: "ÁõÆ", meaning: "eye", onyomi: "„ÇÇ„Åè", kunyomi: "„ÇÅ", example: "ÁõÆ", exReading: "„ÇÅ", exMeaning: "eye", strokes: 5, radical: "ÁõÆ (eye)" },
            { kanji: "ËÄ≥", meaning: "ear", onyomi: "„Åò", kunyomi: "„Åø„Åø", example: "ËÄ≥", exReading: "„Åø„Åø", exMeaning: "ear", strokes: 6, radical: "ËÄ≥ (ear)" },
            { kanji: "Âè£", meaning: "mouth", onyomi: "„Åì„ÅÜ", kunyomi: "„Åè„Å°", example: "ÂÖ•Âè£", exReading: "„ÅÑ„Çä„Åê„Å°", exMeaning: "entrance", strokes: 3, radical: "Âè£ (mouth)" },
            { kanji: "Ëä±", meaning: "flower", onyomi: "„Åã", kunyomi: "„ÅØ„Å™", example: "Ëä±", exReading: "„ÅØ„Å™", exMeaning: "flower", strokes: 7, radical: "Ëâπ (grass)" },
            { kanji: "È≠ö", meaning: "fish", onyomi: "„Åé„Çá", kunyomi: "„Åï„Åã„Å™", example: "È≠ö", exReading: "„Åï„Åã„Å™", exMeaning: "fish", strokes: 11, radical: "È≠ö (fish)" },
            { kanji: "Á©∫", meaning: "sky", onyomi: "„Åè„ÅÜ", kunyomi: "„Åù„Çâ", example: "Á©∫", exReading: "„Åù„Çâ", exMeaning: "sky", strokes: 8, radical: "Á©¥ (hole)" }
        ];

        // ==================== GLOBAL VARIABLES ====================
        let canvases = {}, strokes = { search: [], hw: [] }, currentStroke = { search: [], hw: [] };
        let isDrawing = { search: false, hw: false }, recognitionTimeout = { search: null, hw: null };
        let quizType = 'mixed', quizCount = 50, currentQuiz = [], wrongAnswers = [];
        let hwType = 'mixed', hwQuestions = [], hwCurrentIndex = 0, hwCorrect = 0, hwTotal = 0;
        let currentSvgData = null;

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', function() {
            generateKanjiCards();
            initCanvas('search');
            initCanvas('hw');
        });

        function showSection(id, btn) {
            document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
        }

        // ==================== KANJI CARDS ====================
        function generateKanjiCards() {
            const grid = document.getElementById('kanjiGrid');
            kanjiData.forEach(item => {
                const card = document.createElement('div');
                card.className = 'kanji-card';
                card.dataset.kanji = item.kanji;
                card.dataset.meaning = item.meaning.toLowerCase();
                card.dataset.onyomi = item.onyomi;
                card.dataset.kunyomi = item.kunyomi;
                card.onclick = () => showStrokeOrder(item);
                card.innerHTML = `<div class="kanji-char">${item.kanji}</div><div class="kanji-meaning">${item.meaning}</div><div class="kanji-readings"><div><span class="reading-label onyomi">Èü≥Ë™≠„Åø:</span> ${item.onyomi}</div><div><span class="reading-label kunyomi">Ë®ìË™≠„Åø:</span> ${item.kunyomi}</div></div><div class="example-word"><strong>${item.example}</strong><div>${item.exReading} - ${item.exMeaning}</div></div>`;
                grid.appendChild(card);
            });
        }

        function filterKanji() {
            const term = document.getElementById('searchInput').value.toLowerCase().trim();
            let count = 0;
            document.querySelectorAll('.kanji-card').forEach(card => {
                const match = !term || card.dataset.kanji.includes(term) || card.dataset.meaning.includes(term) || card.dataset.onyomi.includes(term) || card.dataset.kunyomi.includes(term);
                card.classList.toggle('hidden', !match);
                if (match) count++;
            });
            document.getElementById('noResults').style.display = count ? 'none' : 'block';
        }

        // ==================== CANVAS ====================
        function initCanvas(type) {
            const canvas = document.getElementById(type === 'search' ? 'searchCanvas' : 'hwCanvas');
            if (!canvas) return;
            canvases[type] = canvas;
            const ctx = canvas.getContext('2d');
            ctx.strokeStyle = '#333'; ctx.lineWidth = 6; ctx.lineCap = 'round'; ctx.lineJoin = 'round';
            canvas.onmousedown = e => startDrawing(e, type);
            canvas.onmousemove = e => draw(e, type);
            canvas.onmouseup = canvas.onmouseout = () => stopDrawing(type);
            canvas.ontouchstart = e => { e.preventDefault(); startDrawing({clientX: e.touches[0].clientX, clientY: e.touches[0].clientY}, type); };
            canvas.ontouchmove = e => { e.preventDefault(); draw({clientX: e.touches[0].clientX, clientY: e.touches[0].clientY}, type); };
            canvas.ontouchend = () => stopDrawing(type);
        }

        function startDrawing(e, type) {
            isDrawing[type] = true; currentStroke[type] = [];
            const pos = getPos(e, type); currentStroke[type].push([pos.x, pos.y]);
            const ctx = canvases[type].getContext('2d'); ctx.beginPath(); ctx.moveTo(pos.x, pos.y);
        }

        function draw(e, type) {
            if (!isDrawing[type]) return;
            const pos = getPos(e, type); currentStroke[type].push([pos.x, pos.y]);
            const ctx = canvases[type].getContext('2d'); ctx.lineTo(pos.x, pos.y); ctx.stroke();
        }

        function stopDrawing(type) {
            if (isDrawing[type] && currentStroke[type].length > 0) {
                strokes[type].push(currentStroke[type]);
                clearTimeout(recognitionTimeout[type]);
                recognitionTimeout[type] = setTimeout(() => recognizeWithGoogle(type), 400);
            }
            isDrawing[type] = false;
        }

        function getPos(e, type) {
            const c = canvases[type], r = c.getBoundingClientRect();
            return { x: (e.clientX - r.left) * (c.width / r.width), y: (e.clientY - r.top) * (c.height / r.height) };
        }

        function clearCanvas(type) {
            canvases[type].getContext('2d').clearRect(0, 0, canvases[type].width, canvases[type].height);
            strokes[type] = []; currentStroke[type] = [];
            document.getElementById(type === 'search' ? 'searchCandidates' : 'hwCandidates').innerHTML = '<span class="recognition-status">Êº¢Â≠ó„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ...</span>';
        }

        function undoStroke(type) {
            if (strokes[type].length > 0) {
                strokes[type].pop();
                const ctx = canvases[type].getContext('2d');
                ctx.clearRect(0, 0, canvases[type].width, canvases[type].height);
                strokes[type].forEach(s => { ctx.beginPath(); ctx.moveTo(s[0][0], s[0][1]); s.forEach(p => ctx.lineTo(p[0], p[1])); ctx.stroke(); });
                if (strokes[type].length > 0) { clearTimeout(recognitionTimeout[type]); recognitionTimeout[type] = setTimeout(() => recognizeWithGoogle(type), 400); }
                else document.getElementById(type === 'search' ? 'searchCandidates' : 'hwCandidates').innerHTML = '<span class="recognition-status">Êº¢Â≠ó„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ...</span>';
            }
        }

        async function recognizeWithGoogle(type) {
            if (!strokes[type].length) return;
            const cid = type === 'search' ? 'searchCandidates' : 'hwCandidates';
            document.getElementById(cid).innerHTML = '<span class="recognition-status" style="color:#667eea">Ë™çË≠ò‰∏≠...</span>';
            try {
                const res = await fetch('https://inputtools.google.com/request?itc=ja-t-i0-handwrit&app=demopage', {
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ options: "enable_pre_space", requests: [{ writing_guide: { writing_area_width: 280, writing_area_height: 280 }, ink: strokes[type].map(s => [s.map(p => p[0]), s.map(p => p[1])]), language: "ja" }] })
                });
                const data = await res.json();
                if (data[0] === 'SUCCESS' && data[1]?.[0]?.[1]) {
                    const cands = data[1][0][1].slice(0, 8);
                    document.getElementById(cid).innerHTML = cands.map(c => `<span class="candidate" ${type === 'search' ? `onclick="selectSearchCandidate('${c}')"` : ''}>${c}</span>`).join('');
                } else document.getElementById(cid).innerHTML = '<span class="recognition-status" style="color:#dc3545">Ë™çË≠ò„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü</span>';
            } catch { document.getElementById(cid).innerHTML = '<span class="recognition-status" style="color:#dc3545">„Ç®„É©„Éº</span>'; }
        }

        function selectSearchCandidate(c) { document.getElementById('searchInput').value = c; filterKanji(); clearCanvas('search'); }

        // ==================== QUIZ ====================
        function setQuizType(t, btn) { quizType = t; document.querySelectorAll('#quizOptions .option-group:first-of-type .filter-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); }
        function setQuizCount(c, btn) { quizCount = c; document.querySelectorAll('#quizOptions .option-group:nth-of-type(2) .filter-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); }

        function getUniqueOpts(field, correct) {
            const all = kanjiData.map(k => k[field]).filter(v => v && v !== correct && !v.includes('-'));
            return [...new Set(all)].sort(() => Math.random() - 0.5).slice(0, 3);
        }

        function createQ(item, type) {
            let q, ans, cls;
            if (type === 'meaning') { q = `<span class="kanji-display meaning-q">${item.kanji}</span> „ÅÆÊÑèÂë≥„ÅØÔºü`; ans = item.meaning; cls = 'meaning-q'; }
            else if (type === 'onyomi') { if (item.onyomi.includes('-')) return null; q = `<span class="kanji-display onyomi-q">${item.kanji}</span> „ÅÆÈü≥Ë™≠„Åø„ÅØÔºü`; ans = item.onyomi; cls = 'onyomi-q'; }
            else { if (item.kunyomi.includes('-')) return null; q = `<span class="kanji-display kunyomi-q">${item.kanji}</span> „ÅÆË®ìË™≠„Åø„ÅØÔºü`; ans = item.kunyomi; cls = 'kunyomi-q'; }
            let opts = getUniqueOpts(type === 'meaning' ? 'meaning' : type, ans);
            if (opts.length < 3) return null;
            const idx = Math.floor(Math.random() * 4);
            opts.splice(idx, 0, ans);
            return { kanji: item.kanji, q, opts: opts.slice(0, 4), ans: idx, cls };
        }

        function genQuestions(type, count, src = null) {
            const qs = [], list = (src || [...kanjiData]).sort(() => Math.random() - 0.5);
            const types = type === 'mixed' ? ['meaning', 'onyomi', 'kunyomi'] : [type];
            for (let item of list) {
                if (qs.length >= count) break;
                const qObj = createQ(item, types[Math.floor(Math.random() * types.length)]);
                if (qObj) qs.push(qObj);
            }
            return qs;
        }

        function startQuiz() {
            currentQuiz = genQuestions(quizType, quizCount);
            if (!currentQuiz.length) { alert('ÂïèÈ°å„ÇíÁîüÊàê„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü'); return; }
            wrongAnswers = [];
            document.getElementById('quizOptions').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'block';
            document.getElementById('retryBtn').style.display = 'none';
            document.getElementById('result').style.display = 'none';
            renderQuiz();
        }

        function renderQuiz() {
            document.getElementById('quizProgress').textContent = 'ÂïèÈ°åÊï∞: ' + currentQuiz.length + 'Âïè';
            document.getElementById('quizQuestions').innerHTML = currentQuiz.map((q, i) => `
                <div class="quiz-question" id="q${i}">
                    <span class="question-number">Âïè${i + 1}</span>
                    <div class="question-text">${q.q}</div>
                    <div class="options">${q.opts.map((o, j) => `<div class="option" id="opt${i}-${j}" onclick="selectOpt(${i},${j})"><input type="radio" name="q${i}" value="${j}"><span class="option-number">${j + 1}</span><label>${o}</label></div>`).join('')}</div>
                </div>
            `).join('');
        }

        function selectOpt(qi, oi) {
            for (let j = 0; j < 4; j++) document.getElementById('opt' + qi + '-' + j)?.classList.remove('selected');
            document.getElementById('opt' + qi + '-' + oi).classList.add('selected');
            document.querySelector(`input[name="q${qi}"][value="${oi}"]`).checked = true;
        }

        function checkAnswers() {
            let correct = 0;
            wrongAnswers = [];
            currentQuiz.forEach((q, i) => {
                const sel = document.querySelector(`input[name="q${i}"]:checked`);
                for (let j = 0; j < 4; j++) document.getElementById('opt' + i + '-' + j)?.classList.remove('correct', 'incorrect', 'selected');
                // Mark correct answer YELLOW
                document.getElementById('opt' + i + '-' + q.ans).classList.add('correct');
                if (sel) {
                    const v = parseInt(sel.value);
                    if (v === q.ans) {
                        // –í–µ—Ä–µ–Ω –æ—Ç–≥–æ–≤–æ—Ä ‚Üí –ó–ï–õ–ï–ù–û
                        document.getElementById('opt' + i + '-' + q.ans).classList.add('correct-selected');
                        correct++;
                    } else {
                        // –ì—Ä–µ—à–µ–Ω –æ—Ç–≥–æ–≤–æ—Ä ‚Üí –ß–ï–†–í–ï–ù–û, –≤–µ—Ä–Ω–∏—è—Ç ‚Üí –ñ–™–õ–¢–û
                        document.getElementById('opt' + i + '-' + v).classList.add('incorrect');
                        document.getElementById('opt' + i + '-' + q.ans).classList.add('correct');
                        wrongAnswers.push(q);
                    }
                } else {
                    // –ù–µ –µ –∏–∑–±—Ä–∞–Ω–æ –Ω–∏—â–æ ‚Üí –≤–µ—Ä–Ω–∏—è—Ç –ñ–™–õ–¢
                    document.getElementById('opt' + i + '-' + q.ans).classList.add('correct');
                    wrongAnswers.push(q);
                }
            });
            const pct = Math.round(100 * correct / currentQuiz.length);
            const res = document.getElementById('result');
            res.textContent = `Ê≠£Ëß£: ${correct}/${currentQuiz.length} (${pct}%) ‚Äî ${pct >= 80 ? 'Á¥†Êô¥„Çâ„Åó„ÅÑÔºÅüéâ' : pct >= 60 ? '„ÇÇ„ÅÜÂ∞ë„ÅóÔºÅüí™' : 'Âæ©Áøí„Åó„Çà„ÅÜÔºÅüìö'}`;
            res.className = pct >= 80 ? 'good' : pct >= 60 ? 'medium' : 'poor';
            res.style.display = 'block';
            document.getElementById('retryBtn').style.display = wrongAnswers.length ? 'inline-block' : 'none';
            res.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function retryWrong() {
            const items = wrongAnswers.map(q => kanjiData.find(k => k.kanji === q.kanji)).filter(Boolean);
            currentQuiz = genQuestions(quizType, items.length, items);
            wrongAnswers = [];
            document.getElementById('retryBtn').style.display = 'none';
            document.getElementById('result').style.display = 'none';
            renderQuiz();
            window.scrollTo({ top: document.getElementById('quizContainer').offsetTop, behavior: 'smooth' });
        }

        function showQuizOptions() {
            document.getElementById('quizOptions').style.display = 'block';
            document.getElementById('quizContainer').style.display = 'none';
        }

        // ==================== HANDWRITING QUIZ ====================
        function setHWType(t, btn) { hwType = t; document.querySelectorAll('#hwOptions .filter-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); }

        function startHandwritingQuiz() {
            hwQuestions = genHWQs(hwType); hwCurrentIndex = 0; hwCorrect = 0; hwTotal = 0;
            document.getElementById('hwOptions').style.display = 'none';
            document.getElementById('hwQuizContainer').style.display = 'block';
            showHWQ();
        }

        function genHWQs(type) {
            const qs = [], shuffled = [...kanjiData].sort(() => Math.random() - 0.5);
            const types = type === 'mixed' ? ['meaning', 'onyomi', 'kunyomi'] : [type];
            shuffled.forEach(item => {
                const t = types[Math.floor(Math.random() * types.length)];
                let hint, cls;
                if (t === 'meaning') { hint = item.meaning; cls = 'meaning-q'; }
                else if (t === 'onyomi') { if (item.onyomi.includes('-')) return; hint = item.onyomi + ' (' + item.meaning + ')'; cls = 'onyomi-q'; }
                else { if (item.kunyomi.includes('-')) return; hint = item.kunyomi + ' (' + item.meaning + ')'; cls = 'kunyomi-q'; }
                qs.push({ kanji: item.kanji, hint, meaning: item.meaning, cls });
            });
            return qs;
        }

        function showHWQ() {
            if (hwCurrentIndex >= hwQuestions.length) { hwCurrentIndex = 0; hwQuestions.sort(() => Math.random() - 0.5); }
            const q = hwQuestions[hwCurrentIndex];
            document.getElementById('hwProgress').textContent = 'Ê≠£Ëß£: ' + hwCorrect + ' / ÂõûÁ≠î: ' + hwTotal;
            document.getElementById('hwQuestion').innerHTML = `<span class="kanji-display ${q.cls}">${q.hint}</span>`;
            document.getElementById('hwHint').textContent = 'ÊÑèÂë≥: ' + q.meaning;
            document.getElementById('hwResult').style.display = 'none';
            document.getElementById('hwNextControls').style.display = 'none';
            document.getElementById('hwCandidates').innerHTML = '<span class="recognition-status">Êº¢Â≠ó„ÇíÊõ∏„ÅÑ„Å¶„ÄåÁ¢∫Ë™ç„Åô„Çã„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ</span>';
            clearCanvas('hw');
        }

        function checkHandwriting() {
            const cands = document.querySelectorAll('#hwCandidates .candidate');
            if (!cands.length) { alert('„Åæ„ÅöÊº¢Â≠ó„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ'); return; }
            const q = hwQuestions[hwCurrentIndex];
            const ok = Array.from(cands).some(c => c.textContent === q.kanji);
            hwTotal++; if (ok) hwCorrect++;
            const r = document.getElementById('hwResult');
            r.style.display = 'block';
            r.className = 'hw-result ' + (ok ? 'correct' : 'incorrect');
            r.innerHTML = ok ? `<strong>Ê≠£Ëß£ÔºÅüéâ</strong> ${q.kanji} (${q.meaning})` : `<strong>‰∏çÊ≠£Ëß£</strong><br>Ê≠£Ëß£: <span style="font-size:2em">${q.kanji}</span> (${q.meaning})`;
            document.getElementById('hwProgress').textContent = 'Ê≠£Ëß£: ' + hwCorrect + ' / ÂõûÁ≠î: ' + hwTotal;
            document.getElementById('hwNextControls').style.display = 'flex';
        }

        function nextHandwritingQuestion() { hwCurrentIndex++; showHWQ(); }
        function showHWOptions() { document.getElementById('hwOptions').style.display = 'block'; document.getElementById('hwQuizContainer').style.display = 'none'; }

        // ==================== STROKE ORDER MODAL ====================
        function showStrokeOrder(item) {
            document.getElementById('modalKanji').textContent = item.kanji;
            document.getElementById('modalMeaning').innerHTML = '<strong style="color:#e91e63">ÊÑèÂë≥:</strong> ' + item.meaning;
            document.getElementById('modalOnyomi').innerHTML = '<strong style="color:#ff9800">Èü≥Ë™≠„Åø:</strong> ' + item.onyomi;
            document.getElementById('modalKunyomi').innerHTML = '<strong style="color:#2196f3">Ë®ìË™≠„Åø:</strong> ' + item.kunyomi;
            document.getElementById('modalExample').innerHTML = '<strong>‰æã:</strong> ' + item.example + ' (' + item.exReading + ') - ' + item.exMeaning;
            document.getElementById('modalStrokes').innerHTML = '<strong>ÁîªÊï∞:</strong> ' + item.strokes + 'Áîª | <strong>ÈÉ®È¶ñ:</strong> ' + item.radical;
            document.getElementById('strokeInfo').style.display = 'none';
            loadStrokeOrder(item.kanji);
            document.getElementById('strokeModal').classList.add('show');
        }

        function closeModal() { document.getElementById('strokeModal').classList.remove('show'); }

        async function loadStrokeOrder(kanji) {
            const container = document.getElementById('strokeOrderDisplay');
            container.innerHTML = '<p style="color:#667eea">Ë™≠„ÅøËæº„Åø‰∏≠...</p>';
            const code = kanji.charCodeAt(0).toString(16).padStart(5, '0');
            try {
                const res = await fetch('https://raw.githubusercontent.com/KanjiVG/kanjivg/master/kanji/' + code + '.svg');
                if (res.ok) {
                    let svg = await res.text();
                    // FIXED: Remove ALL XML/DOCTYPE declarations that cause ]> to appear
                    svg = svg.replace(/<\?xml[^?]*\?>/gi, '');
                    svg = svg.replace(/<!DOCTYPE[^>]*>/gi, '');
                    svg = svg.replace(/<!ENTITY[^>]*>/gi, '');
                    svg = svg.replace(/\[[\s\S]*?\]>/gi, '');
                    svg = svg.replace(/\]>/g, '');
                    currentSvgData = svg;
                    container.innerHTML = svg;
                    const svgEl = container.querySelector('svg');
                    if (svgEl) { svgEl.setAttribute('width', '200'); svgEl.setAttribute('height', '200'); prepSVG(svgEl); }
                } else { container.innerHTML = '<p style="color:#999">Êõ∏„ÅçÈ†Ü„Éá„Éº„Çø„Å™„Åó</p>'; currentSvgData = null; }
            } catch { container.innerHTML = '<p style="color:#dc3545">Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº</p>'; currentSvgData = null; }
        }

        function prepSVG(svg) {
            svg.querySelectorAll('path').forEach((p, i) => {
                if (p.getTotalLength) {
                    const len = p.getTotalLength();
                    p.style.strokeDasharray = len;
                    p.style.strokeDashoffset = '0';
                    p.dataset.len = len;
                    p.dataset.idx = i;
                    p.style.stroke = '#000';
                    p.style.fill = 'none';
                }
            });
        }

        function resetStrokes() {
            if (currentSvgData) {
                document.getElementById('strokeOrderDisplay').innerHTML = currentSvgData;
                const svg = document.getElementById('strokeOrderDisplay').querySelector('svg');
                if (svg) { svg.setAttribute('width', '200'); svg.setAttribute('height', '200'); prepSVG(svg); }
            }
            document.getElementById('strokeInfo').style.display = 'none';
        }

        function animateStrokes() {
            resetStrokes();
            setTimeout(() => {
                const paths = document.querySelectorAll('#strokeOrderDisplay path');
                paths.forEach(p => { if (p.dataset.len) { p.style.strokeDashoffset = p.dataset.len; p.style.transition = 'none'; } });
                setTimeout(() => {
                    paths.forEach((p, i) => {
                        if (p.dataset.len) setTimeout(() => { p.style.transition = 'stroke-dashoffset 0.4s ease'; p.style.strokeDashoffset = '0'; }, i * 400);
                    });
                }, 50);
            }, 100);
        }

        function showRadicals() {
            const svg = document.querySelector('#strokeOrderDisplay svg');
            if (!svg) return;
            const colors = ['#e91e63', '#2196f3', '#4caf50', '#ff9800', '#9c27b0', '#00bcd4'];
            const groups = svg.querySelectorAll('g[id]');
            let info = [];
            groups.forEach((g, i) => {
                const el = g.getAttribute('kvg:element') || g.getAttribute('element') || '';
                const color = colors[i % colors.length];
                g.querySelectorAll('path').forEach(p => { p.style.stroke = color; p.style.strokeWidth = '4'; });
                if (el) info.push(`<span style="color:${color};font-weight:bold;font-size:1.3em">${el}</span>`);
            });
            const infoDiv = document.getElementById('strokeInfo');
            if (info.length) { infoDiv.innerHTML = '<strong>ÈÉ®È¶ñ„ÉªÊßãÊàêË¶ÅÁ¥†:</strong> ' + info.join(' '); infoDiv.style.display = 'block'; }
        }

        function showComponents() {
            const svg = document.querySelector('#strokeOrderDisplay svg');
            if (!svg) return;
            const colors = ['#4caf50', '#e91e63', '#2196f3', '#ff9800', '#9c27b0', '#ff5722', '#607d8b'];
            const groups = svg.querySelectorAll('g');
            let info = [], cnt = 0;
            groups.forEach(g => {
                const el = g.getAttribute('kvg:element') || g.getAttribute('element');
                if (el && el.length === 1) {
                    const color = colors[cnt % colors.length];
                    const paths = g.querySelectorAll(':scope > path');
                    if (paths.length) {
                        paths.forEach(p => { p.style.stroke = color; p.style.strokeWidth = '4'; });
                        info.push(`<span style="color:${color};font-weight:bold;font-size:1.3em">${el}</span>`);
                        cnt++;
                    }
                }
            });
            const infoDiv = document.getElementById('strokeInfo');
            infoDiv.innerHTML = info.length ? '<strong>ÈÉ®ÂìÅ„Ç∞„É´„Éº„Éó:</strong> ' + info.join(' + ') : '<strong>ÈÉ®ÂìÅ:</strong> Âçò‰∏ÄÈÉ®ÂìÅ„ÅÆÊº¢Â≠ó„Åß„Åô';
            infoDiv.style.display = 'block';
        }
    </script>
</body>
</html>
